{"ast":null,"code":"//acciones con axios async\n//usamos thunk\nimport axios from 'axios';\nimport Creators from './actions';\nimport shopifyCreators from '../shopifystore/actions';\nvar setVariants = Creators.setVariants;\nvar solveVariant = Creators.solveVariant;\nvar closeModal = Creators.closeModal;\nvar stepVariant = Creators.stepVariant;\nvar _shopExists = shopifyCreators.shopExists; // A ===================\n//funciones que uso internamente en este archivo\n//pero que el componente no necesita ejecutar\n\nvar _saveShopifyData = Creators.saveShopifyData; // B ===================\n//fuciones que se conectan con apis\n//async usan thunk\n\nvar reviewVariants = function reviewVariants(payload) {\n  return function (dispatch, getState) {\n    var shop = getState().shopify.shop;\n    axios.post(\"/store/\".concat(shop.id, \"/review_variants\"), payload).then(function (response) {\n      dispatch(setVariants(response.data.store.variants));\n      dispatch(_shopExists(response.data.store));\n      console.log('reviewVariants success', response);\n    }, function (error) {\n      console.log('reviewVariants error', error);\n    });\n  };\n};\n\nvar updateVariantSelections = function updateVariantSelections() {\n  return function (dispatch, getState) {\n    var variants_with_conflict = getState().variant.variants_with_conflict;\n    var shop = getState().shopify.shop;\n    var shopify_variants = variants_with_conflict.map(function (e) {\n      return {\n        id: e.variant_id,\n        price: e.price_selected === 'recommended' ? e.variant_recommended_price : e.variant_price\n      };\n    });\n    var instance = axios.create({\n      baseURL: '/api',\n      timeout: 5000\n    });\n    return instance.put('/shopify', {\n      shopify_variants: shopify_variants\n    }).then(function (response) {\n      console.debug('updateVariantSelections success', response);\n      var backendVariants = variants_with_conflict.map(function (e) {\n        return {\n          _id: e._id,\n          price_selected: e.price_selected\n        };\n      });\n      axios.put(\"/store/\".concat(shop.id, \"/finish\"), {\n        variants_with_conflict: backendVariants\n      }).then(function (response) {\n        //Guardando nuevos status en redux\n        dispatch(_shopExists(response.data.store));\n        dispatch(setVariants(response.data.store.variants));\n        dispatch(closeModal());\n      }, function (error) {});\n    }, function (error) {\n      console.debug('updateVariantSelections error', error);\n    });\n  };\n}; // C ===================\n//exportar las funciones que finalmente se van a comunicar\n//con los componentes reales es decir tienen comunicacion\n//con el exterior\n\n\nexport default {\n  reviewVariants: reviewVariants,\n  solveVariant: solveVariant,\n  closeModal: closeModal,\n  stepVariant: stepVariant,\n  updateVariantSelections: updateVariantSelections\n};","map":{"version":3,"sources":["C:/Users/rafae/Desktop/Bootcamp/Front-Back/app_shopify/store/variant/operations.js"],"names":["axios","Creators","shopifyCreators","setVariants","solveVariant","closeModal","stepVariant","_shopExists","shopExists","_saveShopifyData","saveShopifyData","reviewVariants","payload","dispatch","getState","shop","shopify","post","id","then","response","data","store","variants","console","log","error","updateVariantSelections","variants_with_conflict","variant","shopify_variants","map","e","variant_id","price","price_selected","variant_recommended_price","variant_price","instance","create","baseURL","timeout","put","debug","backendVariants","_id"],"mappings":"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","sourcesContent":["//acciones con axios async\r\n//usamos thunk\r\n\r\nimport axios from 'axios'\r\nimport Creators from './actions'\r\n\r\nimport shopifyCreators from '../shopifystore/actions'\r\n\r\nconst setVariants   = Creators.setVariants\r\nconst solveVariant  = Creators.solveVariant\r\nconst closeModal    = Creators.closeModal\r\nconst stepVariant   = Creators.stepVariant\r\nconst _shopExists   = shopifyCreators.shopExists\r\n\r\n\r\n// A ===================\r\n//funciones que uso internamente en este archivo\r\n//pero que el componente no necesita ejecutar\r\nconst _saveShopifyData  = Creators.saveShopifyData\r\n\r\n\r\n\r\n\r\n// B ===================\r\n//fuciones que se conectan con apis\r\n//async usan thunk\r\nconst reviewVariants = (payload) => {\r\n\r\n    return (dispatch, getState) => {\r\n\r\n        const { shop } = getState().shopify\r\n\r\n        axios.post(`/store/${shop.id}/review_variants`,payload)\r\n            .then(response=>{\r\n                \r\n                dispatch(setVariants(response.data.store.variants))\r\n                dispatch(_shopExists(response.data.store))\r\n\r\n                console.log('reviewVariants success', response)\r\n\r\n            }, error=>{\r\n\r\n                console.log('reviewVariants error', error)\r\n            })\r\n    }\r\n\r\n}\r\n\r\n\r\nconst updateVariantSelections = ()=>{\r\n\r\n    return (dispatch, getState) => {\r\n        \r\n        const { variants_with_conflict } = getState().variant\r\n        const { shop } = getState().shopify\r\n\r\n        const shopify_variants = variants_with_conflict.map(e=>{\r\n            return {\r\n                id: e.variant_id,\r\n                price: e.price_selected==='recommended' ? e.variant_recommended_price : e.variant_price\r\n            }\r\n        })\r\n\r\n\r\n        const instance = axios.create({\r\n            baseURL: '/api',\r\n            timeout: 5000\r\n        })\r\n\r\n        return instance.put('/shopify', { shopify_variants })\r\n        .then(response=>{\r\n            console.debug('updateVariantSelections success', response)\r\n\r\n            const backendVariants = variants_with_conflict.map(e=>{\r\n                return {\r\n                    _id: e._id,\r\n                    price_selected: e.price_selected\r\n                }\r\n            })\r\n\r\n            axios.put(`/store/${shop.id}/finish`, { variants_with_conflict: backendVariants})\r\n                .then(response=>{\r\n                    //Guardando nuevos status en redux\r\n                    dispatch(_shopExists(response.data.store))\r\n                    dispatch(setVariants(response.data.store.variants))\r\n                    dispatch(closeModal())\r\n                },error=>{\r\n\r\n                })\r\n\r\n        },error=>{\r\n            console.debug('updateVariantSelections error', error)\r\n        })\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n// C ===================\r\n//exportar las funciones que finalmente se van a comunicar\r\n//con los componentes reales es decir tienen comunicacion\r\n//con el exterior\r\nexport default {\r\n    reviewVariants,\r\n    solveVariant,\r\n    closeModal,\r\n    stepVariant,\r\n    updateVariantSelections\r\n}"]},"metadata":{},"sourceType":"module"}